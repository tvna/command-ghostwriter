{
  "kinds": [
    { "name": "UserControlled" },
    { "name": "XSS" },
    { "name": "UntrustedData" },
    { "name": "FileSystemAccess" }
  ],
  "sources": [
    { "name": "st_file_uploader" },
    { "name": "st_text_input" },
    { "name": "st_selectbox" },
    { "name": "st_radio" },
    { "name": "st_toggle" },
    { "name": "st_session_state_get" }
  ],
  "sinks": [
    { "name": "AppCore.load_config_file" },
    { "name": "AppCore.load_template_file" },
    { "name": "AppCore.apply" },
    { "name": "st_markdown" },
    { "name": "st_text_area" },
    { "name": "st_json" },
    { "name": "st_download_button" },
    { "name": "AppCore.get_download_content" },
    { "name": "AppCore.get_download_filename" }
  ],
  "rules": [
    {
      "name": "rule_user_input_to_markdown",
      "code": 5001,
      "sources": [
        "st_file_uploader",
        "st_text_input",
        "st_selectbox",
        "st_radio",
        "st_toggle",
        "st_session_state_get"
      ],
      "sinks": ["st_markdown"],
      "message_format": "[5001] User input reaches Streamlit markdown sink (potential XSS)."
    },
    {
      "name": "rule_user_input_to_download",
      "code": 5002,
      "sources": [
        "st_file_uploader",
        "st_text_input",
        "st_selectbox",
        "st_radio",
        "st_toggle",
        "st_session_state_get"
      ],
      "sinks": ["st_download_button", "AppCore.get_download_filename"],
      "message_format": "[5002] User input reaches download button data or filename sink."
    },
    {
      "name": "rule_user_input_flow_through_appcore",
      "code": 5003,
      "sources": [
        "st_file_uploader",
        "st_text_input",
        "st_selectbox",
        "st_radio",
        "st_toggle",
        "st_session_state_get"
      ],
      "sinks": [
        "AppCore.load_config_file",
        "AppCore.load_template_file",
        "AppCore.apply",
        "st_markdown",
        "st_text_area",
        "st_json",
        "st_download_button",
        "AppCore.get_download_content",
        "AppCore.get_download_filename"
      ],
      "message_format": "[5003] User input flows through AppCore to a potentially unsafe sink."
    }
  ],
  "features": []
}
